<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Advanced alphabet techniques</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Advanced alphabet techniques</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(tidysq)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;tidysq&#39;</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:base&#39;:</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt;     paste</span></span></code></pre></div>
<p>Sequences in <code>sq</code> objects are compressed to take up less
storage space. To achieve that, <code>sq</code> objects store an
<code>alphabet</code> attribute that serves as a dictionary of possible
symbols. This attribute can be accessed by its namesake function:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>sq_dna <span class="ot">&lt;-</span> <span class="fu">sq</span>(<span class="fu">c</span>(<span class="st">&quot;CTGAATGCAGT&quot;</span>, <span class="st">&quot;ATGCCGT&quot;</span>, <span class="st">&quot;CAGACCATT&quot;</span>))</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">alphabet</span>(sq_dna)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; &lt;tidysq alphabet[5]&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; [1] A C G T -</span></span></code></pre></div>
<p>It is strongly discouraged to manually assign different alphabet, as
it may result in undesirable behavior.</p>
<div id="standard-alphabets" class="section level2">
<h2>Standard alphabets</h2>
<p>Alphabets can be divided into standard and non-standard types. Both
these groups have similar behavior, but standard alphabets have
additional functionalities available due to their biological
interpretation.</p>
<p>Standard alphabets can be subdivided into basic and extended
alphabets, both groups closely linked. For every standard alphabet there
exists a type such that if an <code>sq</code> object has this type, then
its <code>alphabet</code> attribute has this alphabet as value.</p>
<div id="basic-alphabets" class="section level3">
<h3>Basic alphabets</h3>
<p>There are three predefined basic alphabets — for DNA, RNA and amino
acid sequences. They consist of all letter codes used for bases of given
type, as well as gap letter “-” and (in amino acid case) stop letter
“*”. Alphabets are stored as character vectors with added
<code>sq_alphabet</code> class for additional methods. For instance,
amino acid alphabet contains following letters: A, C, D, E, F, G, H, I,
K, L, M, N, P, Q, R, S, T, V, W, Y, -, *.</p>
<p>Basic DNA/RNA alphabet is necessary for <code>translate()</code>
operation.</p>
</div>
<div id="extended-alphabets" class="section level3">
<h3>Extended alphabets</h3>
<p>For each basic alphabet there is an extended counterpart. These three
extended alphabets contain all letters from the respective basic ones
and, additionally, ambiguous letters (that is, letters that mean
“X-or-Y-or-Z base”, where X, Y and Z are chosen from corresponding base
alphabet).</p>
<p>Both basic and extended alphabets can be acquired using
<code>get_standard_alphabet()</code> function. It uses type interpreting
not to force the user to remember exact type name (although using
consistent naming is beneficial to code readability):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">get_standard_alphabet</span>(<span class="st">&quot;ami_ext&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; &lt;tidysq alphabet[28]&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt;  [1] A B C D E F G H I J K L M N O P Q R S T U V W X Y Z - *</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="fu">get_standard_alphabet</span>(<span class="st">&quot;rna_bsc&quot;</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; &lt;tidysq alphabet[5]&gt;</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; [1] A C G U -</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">get_standard_alphabet</span>(<span class="st">&quot;DNA extended&quot;</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; &lt;tidysq alphabet[16]&gt;</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt;  [1] A C G T W S M K R Y B D H V N -</span></span></code></pre></div>
</div>
<div id="removing-ambiguous-elements" class="section level3">
<h3>Removing ambiguous elements</h3>
<p>When an <code>sq</code> object has an extended type, it can be
converted to the basic one by utilizing <code>remove_ambiguous()</code>
function. It works by removing either sequences where an ambiguous
element is present or just this element, depending on
<code>by_letter</code> parameter value. In the example below
<code>N</code> is such an element:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>sq_rna <span class="ot">&lt;-</span> <span class="fu">sq</span>(<span class="fu">c</span>(<span class="st">&quot;UCGGNNCAGNN&quot;</span>, <span class="st">&quot;AUUCGGUGA&quot;</span>, <span class="st">&quot;CNCUUANNNCNU&quot;</span>))</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>sq_rna</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; extended RNA sequences list:</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; [1] UCGGNNCAGNN                                                             &lt;11&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; [2] AUUCGGUGA                                                                &lt;9&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; [3] CNCUUANNNCNU                                                            &lt;12&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">remove_ambiguous</span>(sq_rna)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; basic RNA sequences list:</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; [1] &lt;NULL&gt;                                                                   &lt;0&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; [2] AUUCGGUGA                                                                &lt;9&gt;</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; [3] &lt;NULL&gt;                                                                   &lt;0&gt;</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="fu">remove_ambiguous</span>(sq_rna, <span class="at">by_letter =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; basic RNA sequences list:</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; [1] UCGGCAG                                                                  &lt;7&gt;</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; [2] AUUCGGUGA                                                                &lt;9&gt;</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; [3] CCUUACU                                                                  &lt;7&gt;</span></span></code></pre></div>
<p>Should the user wish to keep the original lengths of sequences
unchanged, it’s more appropriate to use
<code>substitute_letters()</code> function instead. The most obvious
replacement is “-” gap letter, present in all standard alphabets:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">substitute_letters</span>(sq_rna, <span class="fu">c</span>(<span class="at">N =</span> <span class="st">&quot;-&quot;</span>))</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; atp (atypical alphabet) sequences list:</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; [1] UCGG--CAG--                                                             &lt;11&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; [2] AUUCGGUGA                                                                &lt;9&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; [3] C-CUUA---C-U                                                            &lt;12&gt;</span></span></code></pre></div>
<p>Notice, however, that returned object has <code>atp</code> alphabet
instead. More on handling that in <a href="#type_manipulation">chapter
about changing sq types</a>.</p>
</div>
</div>
<div id="non-standard-alphabets" class="section level2">
<h2>Non-standard alphabets</h2>
<p>Non-standard alphabet group consists of two types: untyped
(<code>unt</code>) and atypical (<code>atp</code>). The former is a
result of not specifying alphabet and being unable to find a standard
alphabet that would contain all letters appearing in sequences. The
latter, on the other hand, is used whenever the user specifies used
alphabet explicitly. The difference can be best shown with calls to
constructing <code>sq()</code> function:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">sq</span>(<span class="fu">c</span>(<span class="st">&quot;PFN&amp;I&amp;VO*&amp;P&quot;</span>, <span class="st">&quot;&amp;IO*&amp;PVO&quot;</span>))</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; unt (unspecified type) sequences list:</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; [1] PFN&amp;I&amp;VO*&amp;P                                                             &lt;11&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; [2] &amp;IO*&amp;PVO                                                                 &lt;8&gt;</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">sq</span>(<span class="fu">c</span>(<span class="st">&quot;PFN&amp;I&amp;VO*&amp;P&quot;</span>, <span class="st">&quot;&amp;IO*&amp;PVO&quot;</span>),</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>   <span class="at">alphabet =</span> <span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;I&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;O&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="st">&quot;V&quot;</span>, <span class="st">&quot;&amp;&quot;</span>, <span class="st">&quot;*&quot;</span>))</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; atp (atypical alphabet) sequences list:</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; [1] PFN&amp;I&amp;VO*&amp;P                                                             &lt;11&gt;</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; [2] &amp;IO*&amp;PVO                                                                 &lt;8&gt;</span></span></code></pre></div>
<p>Obviously, as with standard alphabets, atypical ones can also contain
more letters than actually appear:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">sq</span>(<span class="fu">c</span>(<span class="st">&quot;PFN&amp;I&amp;VO*&amp;P&quot;</span>, <span class="st">&quot;&amp;IO*&amp;PVO&quot;</span>),</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>   <span class="at">alphabet =</span> <span class="fu">c</span>(<span class="st">&quot;E&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;I&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;O&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="st">&quot;Q&quot;</span>, <span class="st">&quot;V&quot;</span>, <span class="st">&quot;&amp;&quot;</span>, <span class="st">&quot;*&quot;</span>, <span class="st">&quot;:&quot;</span>))</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; atp (atypical alphabet) sequences list:</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; [1] PFN&amp;I&amp;VO*&amp;P                                                             &lt;11&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; [2] &amp;IO*&amp;PVO                                                                 &lt;8&gt;</span></span></code></pre></div>
<div id="multicharacter-alphabets" class="section level3">
<h3>Multicharacter alphabets</h3>
<p>The main usage of atypical alphabets is to allow the user to handle
data with multicharacter letters. For example sometimes amino acid
sequences are described using three-character codes. These can be
handled as shown below (although with specifying all, not only a handful
of codes):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>sq_multichar <span class="ot">&lt;-</span> <span class="fu">sq</span>(<span class="fu">c</span>(<span class="st">&quot;TyrGlyArgArgAsp&quot;</span>, <span class="st">&quot;AspGlyArgGly&quot;</span>, <span class="st">&quot;CysGluGlyTyrProArg&quot;</span>),</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                   <span class="at">alphabet =</span> <span class="fu">c</span>(<span class="st">&quot;Arg&quot;</span>, <span class="st">&quot;Asp&quot;</span>, <span class="st">&quot;Cys&quot;</span>, <span class="st">&quot;Glu&quot;</span>, <span class="st">&quot;Gly&quot;</span>, <span class="st">&quot;Pro&quot;</span>, <span class="st">&quot;Tyr&quot;</span>))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>sq_multichar</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; atp (atypical alphabet) sequences list:</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; [1] Tyr Gly Arg Arg Asp                                                      &lt;5&gt;</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; [2] Asp Gly Arg Gly                                                          &lt;4&gt;</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; [3] Cys Glu Gly Tyr Pro Arg                                                  &lt;6&gt;</span></span></code></pre></div>
<p>These letters are treated as a whole, meaning that they are
indivisible. It can be observed during letter replacement operation:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">substitute_letters</span>(sq_multichar, <span class="fu">c</span>(<span class="at">Arg =</span> <span class="st">&quot;X&quot;</span>, <span class="at">Glu =</span> <span class="st">&quot;His&quot;</span>, <span class="at">Pro =</span> <span class="st">&quot;X&quot;</span>))</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; atp (atypical alphabet) sequences list:</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; [1] Tyr Gly X X Asp                                                          &lt;5&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; [2] Asp Gly X Gly                                                            &lt;4&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; [3] Cys His Gly Tyr X X                                                      &lt;6&gt;</span></span></code></pre></div>
</div>
</div>
<div id="type_manipulation" class="section level2">
<h2>Type manipulation</h2>
<p>As shown in previous chapters, <code>substitute_letters()</code>
return an <code>sq</code> object of atp type. If a type isn’t
satisfying, then the user can utilize <code>typify()</code> function
that creates new <code>sq</code> object with desired type (backticks are
necessary, when the substituted letter isn’t a valid variable name):</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>sq_unt <span class="ot">&lt;-</span> <span class="fu">sq</span>(<span class="fu">c</span>(<span class="st">&quot;UCGG&amp;&amp;CAG&amp;&amp;&quot;</span>, <span class="st">&quot;AUUCGGUGA&quot;</span>, <span class="st">&quot;C&amp;CUUA&amp;&amp;&amp;C&amp;U&quot;</span>))</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>sq_sub <span class="ot">&lt;-</span> <span class="fu">substitute_letters</span>(sq_unt, <span class="fu">c</span>(<span class="st">`</span><span class="at">&amp;</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;-&quot;</span>))</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>sq_sub</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt; atp (atypical alphabet) sequences list:</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt; [1] UCGG--CAG--                                                             &lt;11&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; [2] AUUCGGUGA                                                                &lt;9&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; [3] C-CUUA---C-U                                                            &lt;12&gt;</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="fu">typify</span>(sq_sub, <span class="st">&quot;rna_bsc&quot;</span>)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; basic RNA sequences list:</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; [1] UCGG--CAG--                                                             &lt;11&gt;</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; [2] AUUCGGUGA                                                                &lt;9&gt;</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt; [3] C-CUUA---C-U                                                            &lt;12&gt;</span></span></code></pre></div>
<p>However, one should note that there is a requirement for
<code>typify()</code> to work — typified <code>sq</code> object must not
contain any letters not in the target alphabet. For instance, following
call won’t work:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">typify</span>(sq_sub, <span class="st">&quot;dna_bsc&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; Error: sq object contains letters that do not appear in the alphabet of target type</span></span></code></pre></div>
<p>The user isn’t left alone to guess whether a sequence has invalid
letters or not. In this case they can use
<code>find_invalid_letters()</code> function that returns a list of
character vectors, where each vector contains invalid letter for
corresponding sequence:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">find_invalid_letters</span>(sq_sub, <span class="st">&quot;dna_bsc&quot;</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;U&quot;</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;U&quot;</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; [1] &quot;U&quot;</span></span></code></pre></div>
<p>However, all invalid letters within an alphabet have to be
substituted before passing it to <code>typify()</code>. A more
complicated call that replaces all ambiguous letters with “-” gap letter
can be constructed as follows:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>ambiguous_letters <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">get_standard_alphabet</span>(<span class="st">&quot;rna_ext&quot;</span>),</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">get_standard_alphabet</span>(<span class="st">&quot;rna_bsc&quot;</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>encoding <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;-&quot;</span>, <span class="fu">length</span>(ambiguous_letters))</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="fu">names</span>(encoding) <span class="ot">&lt;-</span> ambiguous_letters</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>encoding</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">#&gt;   W   S   M   K   R   Y   B   D   H   V   N </span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt; &quot;-&quot; &quot;-&quot; &quot;-&quot; &quot;-&quot; &quot;-&quot; &quot;-&quot; &quot;-&quot; &quot;-&quot; &quot;-&quot; &quot;-&quot; &quot;-&quot;</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>sq_rna_sub <span class="ot">&lt;-</span> <span class="fu">substitute_letters</span>(sq_rna, encoding)</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="fu">typify</span>(sq_rna_sub, <span class="st">&quot;rna_bsc&quot;</span>)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co">#&gt; atp (atypical alphabet) sequences list:</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#&gt; [1] UCGG--CAG--                                                             &lt;11&gt;</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co">#&gt; [2] AUUCGGUGA                                                                &lt;9&gt;</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co">#&gt; [3] C-CUUA---C-U                                                            &lt;12&gt;</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
